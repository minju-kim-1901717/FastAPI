
# 🧪 Unit Test & Coverage Guide

단위 테스트는 우리가 작성한 코드가 **“예상한 대로 동작하는지”** 검증하는 과정

---

## ✅ 단위 테스트 (Unit Test)

단위테스트는 코드가 의도한 대로 동작하는지를 **자동으로 검증**

- 테스트 실행 중 **예상하지 못한 에러가 한 번도 발생하지 않으면** 테스트 성공
- 반대로 **예상치 못한 에러가 발생하면** 실패로 간주
- 예를 들어, `test_simple()`이 아무것도 검증하지 않더라도 에러 없이 끝나면 “성공한 테스트”

```python
def test_simple():
    # 검증 로직이 없어도, 에러가 없으면 성공
    pass
````

---

## 📊 Coverage

> “Coverage 측정이 없는 단위 테스트는 반쪽짜리 테스트다.”

**Coverage(커버리지)** 는 테스트 코드가 실제 제품 코드를 **얼마나 실행했는지 비율로 나타내는 지표**

### 핵심 요약

* 단위 테스트를 실행했는데 한 번도 실행되지 않은 코드는 “테스트되지 않은 코드”
* 테스트되지 않은 부분에서 버그가 발생하면, 그것은 테스트하지 않은 개발자의 책임
* 따라서 “지금 내가 수정한 코드가 테스트되고 있는가?”를 커버리지로 판단할 필요가 있음
* 커버리지 측정 시 **테스트 코드는 제외(omit)** 하고, **제품 코드만 계산**에 포함해야함

### 실행 명령어

```bash
# 1️⃣ 커버리지 실행
poetry run coverage run -m pytest .

# 2️⃣ 요약 리포트 출력
poetry run coverage report -m

# 3️⃣ HTML 리포트 생성 (브라우저에서 확인 가능)
poetry run coverage html
```

---

## 🧩 Dev Dependency (개발용 종속성)

종속성(Dependencies)은 두 가지로 나뉩니다.

| 구분       | 설명                  | 예시                                            |
| -------- | ------------------- | --------------------------------------------- |
| 실행 시 필요  | 서버가 실행되는 중에 필요한 패키지 | `fastapi`, `uvicorn`, `pydantic`              |
| 개발 시만 필요 | 코드 검사 및 테스트용 도구     | `black`, `ruff`, `mypy`, `pytest`, `coverage` |

* `group=dev` 옵션은 **“이 종속성은 개발할 때만 필요하다”**는 의미
* `poetry add --group dev black` 과 같이 설치할 수 있음

### 장점

* 프로덕션(배포) 환경에서 **불필요한 패키지 설치를 피할 수 있음**
* **빌드 시간과 용량 감소**
* 특히 **Docker / Kubernetes 환경**에서 효과가 크다
  → 이미지 사이즈가 작아지고, 배포 속도가 빨라짐

---

## 🤖 자동화 테스트가 필요한 이유

> “테스트 슈트가 없으면, 개발자는 자신이 수정한 코드가 제대로 작동하는지 확인할 방법이 없다.”

테스트가 없는 프로젝트에서는 작은 수정 하나에도
어디에서 버그가 발생할지 몰라 **변경을 두려워하게 됨**

---


### 테스트의 역할

* 사람이 아니라 **코드가 코드를 검증**하기 때문에 반복 테스트에 유리하다
* 컴퓨터는 **실수하지 않고**, **지치지 않습니다.**
* 테스트는 개발자가 **“수정을 두려워하지 않도록” 만들어줍니다.**

> 결국 테스트는 “**안정된 개발 환경을 보장하는 방패**”

---

## 🧾 정리

| 항목                 | 설명                       |
| ------------------ | ------------------------ |
| **Unit Test**      | 코드가 예상대로 동작하는지 검증        |
| **Coverage**       | 테스트가 제품 코드를 얼마나 커버하는지 측정 |
| **Dev Dependency** | 개발용 종속성 분리로 효율적 관리       |
| **Automation**     | 코드 안정성과 배포 신뢰성 향상        |

---

> 💡 테스트는 “내가 수정한 코드가 의도대로 동작하는지”를 빠르고 정확하게 알려주는 가장 강력한 도구
